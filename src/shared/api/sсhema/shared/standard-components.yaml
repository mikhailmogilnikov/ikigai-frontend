# üß© –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã API

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
parameters:
  # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
  PageParam:
    name: page
    in: query
    schema:
      type: integer
      minimum: 1
      default: 1
    description: "–ù–æ–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 1)"
    example: 1

  LimitParam:
    name: limit
    in: query
    schema:
      type: integer
      minimum: 1
      maximum: 100
      default: 15
    description: "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ (–º–∞–∫—Å. 100)"
    example: 15

  # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞
  SearchParam:
    name: search
    in: query
    schema:
      type: string
      minLength: 1
      maxLength: 100
    description: "–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É"
    example: "–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ"

  # –ü–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏
  SortParam:
    name: sort
    in: query
    schema:
      type: string
      enum: 
        - title_asc
        - title_desc
        - price_asc
        - price_desc
        - created_asc
        - created_desc
        - rating_asc
        - rating_desc
      default: created_desc
    description: "–ü–æ–ª–µ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏"
    example: "title_asc"

  # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ path –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
  CourseIdParam:
    name: courseId
    in: path
    required: true
    schema:
      type: string
      format: uuid
    description: "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫—É—Ä—Å–∞"
    example: "123e4567-e89b-12d3-a456-426614174000"

  LessonIdParam:
    name: lessonId
    in: path
    required: true
    schema:
      type: string
      format: uuid
    description: "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —É—Ä–æ–∫–∞"
    example: "987fcdeb-51a2-43d1-9f4e-123456789abc"

  ModuleIdParam:
    name: moduleId
    in: path
    required: true
    schema:
      type: string
      format: uuid
    description: "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –º–æ–¥—É–ª—è"
    example: "456789ab-cdef-1234-5678-90abcdef1234"

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏
headers:
  X-RateLimit-Limit:
    description: "–õ–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
    schema:
      type: integer
    example: 1000

  X-RateLimit-Remaining:
    description: "–û—Å—Ç–∞–≤—à–µ–µ—Å—è –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Ç–µ–∫—É—â–µ–º –æ–∫–Ω–µ"
    schema:
      type: integer
    example: 999

  X-RateLimit-Reset:
    description: "–í—Ä–µ–º—è —Å–±—Ä–æ—Å–∞ –ª–∏–º–∏—Ç–∞ (Unix timestamp)"
    schema:
      type: integer
    example: 1735689600

  X-Request-ID:
    description: "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏"
    schema:
      type: string
      format: uuid
    example: "req_123e4567e89b12d3a456426614174000"

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
schemas:
  # –ë–∞–∑–æ–≤—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
  StandardSuccessResponse:
    type: object
    properties:
      success:
        type: boolean
        example: true
        description: "–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞"
      message:
        type: string
        example: "–û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ"
        description: "–ß–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ"
      data:
        type: object
        description: "–ü–æ–ª–µ–∑–Ω–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞ –æ—Ç–≤–µ—Ç–∞"
      meta:
        $ref: '#/schemas/ResponseMeta'
    required:
      - success

  ResponseMeta:
    type: object
    properties:
      timestamp:
        type: string
        format: date-time
        example: "2024-01-15T10:30:00Z"
        description: "–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞"
      request_id:
        type: string
        format: uuid
        example: "req_123e4567e89b12d3a456426614174000"
        description: "–ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏"
      api_version:
        type: string
        example: "2.0.0"
        description: "–í–µ—Ä—Å–∏—è API"

  # –ü–∞–≥–∏–Ω–∞—Ü–∏—è
  PaginationMeta:
    type: object
    properties:
      current_page:
        type: integer
        minimum: 1
        example: 1
        description: "–¢–µ–∫—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"
      total_pages:
        type: integer
        minimum: 0
        example: 10
        description: "–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–∞–Ω–∏—Ü"
      total_items:
        type: integer
        minimum: 0
        example: 150
        description: "–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤"
      items_per_page:
        type: integer
        minimum: 1
        example: 15
        description: "–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ"
      has_next:
        type: boolean
        example: true
        description: "–ï—Å—Ç—å –ª–∏ —Å–ª–µ–¥—É—é—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"
      has_prev:
        type: boolean
        example: false
        description: "–ï—Å—Ç—å –ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞"

  PaginatedResponse:
    allOf:
      - $ref: '#/schemas/StandardSuccessResponse'
      - type: object
        properties:
          data:
            type: object
            properties:
              items:
                type: array
                description: "–ú–∞—Å—Å–∏–≤ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã"
              pagination:
                $ref: '#/schemas/PaginationMeta'

  # –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏
  Timestamps:
    type: object
    properties:
      created_at:
        type: string
        format: date-time
        example: "2024-01-15T10:30:00Z"
        description: "–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è —Å–æ–∑–¥–∞–Ω–∏—è"
      updated_at:
        type: string
        format: date-time
        example: "2024-01-15T10:30:00Z"
        description: "–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è"

  # –ë–∞–∑–æ–≤–∞—è —Å—É—â–Ω–æ—Å—Ç—å
  BaseEntity:
    type: object
    properties:
      id:
        type: string
        format: uuid
        example: "123e4567-e89b-12d3-a456-426614174000"
        description: "–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä"
    allOf:
      - $ref: '#/schemas/Timestamps'
    required:
      - id

# –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
responses:
  # –£—Å–ø–µ—à–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã
  SuccessResponse:
    description: "–û–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ"
    headers:
      X-Request-ID:
        $ref: '#/headers/X-Request-ID'
    content:
      application/json:
        schema:
          $ref: '#/schemas/StandardSuccessResponse'

  CreatedResponse:
    description: "–†–µ—Å—É—Ä—Å —É—Å–ø–µ—à–Ω–æ —Å–æ–∑–¥–∞–Ω"
    headers:
      X-Request-ID:
        $ref: '#/headers/X-Request-ID'
      Location:
        description: "URL —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞"
        schema:
          type: string
          format: uri
    content:
      application/json:
        schema:
          $ref: '#/schemas/StandardSuccessResponse'

  # –û—Ç–≤–µ—Ç—ã —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π
  PaginatedListResponse:
    description: "–°–ø–∏—Å–æ–∫ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π"
    headers:
      X-Request-ID:
        $ref: '#/headers/X-Request-ID'
      X-RateLimit-Limit:
        $ref: '#/headers/X-RateLimit-Limit'
      X-RateLimit-Remaining:
        $ref: '#/headers/X-RateLimit-Remaining'
    content:
      application/json:
        schema:
          $ref: '#/schemas/PaginatedResponse'

  # Rate limiting
  RateLimitExceededResponse:
    description: "–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤"
    headers:
      X-RateLimit-Limit:
        $ref: '#/headers/X-RateLimit-Limit'
      X-RateLimit-Reset:
        $ref: '#/headers/X-RateLimit-Reset'
      X-Request-ID:
        $ref: '#/headers/X-Request-ID'
    content:
      application/json:
        schema:
          allOf:
            - $ref: '../responses.yaml#/schemas/ErrorSchema'
            - type: object
              properties:
                message:
                  example: "–ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ."
                code:
                  example: "RATE_LIMIT_EXCEEDED"

# –ì—Ä—É–ø–ø—ã –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–ª—è —á–∞—Å—Ç—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
parameterGroups:
  PaginationParams:
    - $ref: '#/parameters/PageParam'
    - $ref: '#/parameters/LimitParam'

  SearchAndSortParams:
    - $ref: '#/parameters/SearchParam'
    - $ref: '#/parameters/SortParam'

  FullListParams:
    - $ref: '#/parameters/PageParam'
    - $ref: '#/parameters/LimitParam'
    - $ref: '#/parameters/SearchParam'
    - $ref: '#/parameters/SortParam' 